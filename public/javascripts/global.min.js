var container,i,move,emitterSize=20,dotQuantity=40,dotSizeMin=6,dotSizeMax=8,speed=2.4,gravity=.7,explosionQuantity=5,emitter=document.querySelector(".emitter"),explosions=[],currentExplosion=0;function createExplosion(e){var t,n,o,i,a,r,s,d,c,l=new TimelineLite({paused:!0}),m=[];for(a=0;a<dotQuantity;a++)i=document.createElement("div"),m.push(i),i.className="dot",s=getRandom(30,255),d=getRandom(30,230),c=getRandom(30,230),TweenLite.set(i,{backgroundColor:"rgb("+s+","+d+","+c+")",visibility:"hidden"}),r=getRandom(dotSizeMin,dotSizeMax),e.appendChild(i),t=getRandom(.65,.85)*Math.PI*2,o=Math.random()*(emitterSize/2-r/2),n=3+Math.random(),TweenLite.set(i,{x:Math.cos(t)*o,y:Math.sin(t)*o,width:r,height:r,xPercent:-50,yPercent:-50,visibility:"hidden",force3D:!0}),l.to(i,n/2,{opacity:0,ease:RoughEase.ease.config({points:20,strength:1.75,clamp:!0})},0).to(i,n,{visibility:"visible",rotationX:"-="+getRandom(720,1440),rotationZ:"+="+getRandom(720,1440),physics2D:{angle:180*t/Math.PI,velocity:(100+250*Math.random())*speed,gravity:700*gravity,friction:getRandom(.1,.15)}},0).to(i,1.25+Math.random(),{opacity:0},n/2);return l}function explode(e){var t,n=e.getBoundingClientRect();++currentExplosion===explosions.length&&(currentExplosion=0),t=explosions[currentExplosion],TweenLite.set(t.container,{x:n.left+n.width/2,y:n.top+n.height/2}),t.animation.restart()}function getRandom(e,t){return e+Math.random()*(t-e)}function play(){move.play(0);var e=0,t=setInterval((function(){e<5?(explode(emitter),e++):clearInterval(t)}),150)}function setup(){for(i=0;i<explosionQuantity;i++)(container=document.createElement("div")).className="dot-container",document.body.appendChild(container),explosions.push({container:container,animation:createExplosion(container)});move=new TimelineLite({paused:!0}).fromTo(emitter,.4,{left:"40%"},{left:"60%",ease:Linear.easeNone}).fromTo(emitter,.4,{left:"60%"},{left:"40%",ease:Linear.easeNone}),document.querySelector("body").onclick=function(){play()}}setup();